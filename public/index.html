<!doctype html>
<html lang="en" class="bg-slate-50 antialiased">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DNose - Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: { 50: '#eef2ff', 100: '#e0e7ff', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca' }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="/index.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.45);
            backdrop-filter: blur(3px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.2.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.1/",
    "react/": "https://aistudiocdn.com/react@^19.2.1/",
    "chart.js/": "https://aistudiocdn.com/chart.js@^4.5.1/"
  }
}
</script>
</head>
<body class="text-slate-600">

<!-- Navigation -->
<nav class="sticky top-0 z-40 w-full bg-white/80 backdrop-blur-md border-b border-slate-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center gap-3">
                <img class="h-8 w-auto" src="/logo.png" alt="DNose Logo"/>
                <span class="font-bold text-xl text-slate-800 tracking-tight">DNose</span>
            </div>
            <div class="hidden md:block">
                <div class="ml-10 flex items-baseline space-x-4">
                    <a href="/" class="text-primary-600 bg-primary-50 px-3 py-2 rounded-md text-sm font-medium border border-primary-100">Home</a>
                    <a href="/projects.html" class="text-slate-600 hover:text-primary-600 hover:bg-slate-50 px-3 py-2 rounded-md text-sm font-medium transition-colors">Projects</a>
                    <a href="/solutions.html" class="text-slate-600 hover:text-primary-600 hover:bg-slate-50 px-3 py-2 rounded-md text-sm font-medium transition-colors">Recommendations</a>
                    <a href="/mining.html" class="text-slate-600 hover:text-primary-600 hover:bg-slate-50 px-3 py-2 rounded-md text-sm font-medium transition-colors">Mining</a>
                    <a href="/config.html" class="text-slate-600 hover:text-primary-600 hover:bg-slate-50 px-3 py-2 rounded-md text-sm font-medium transition-colors">Config</a>
                    <a href="/about.html" class="text-slate-600 hover:text-primary-600 hover:bg-slate-50 px-3 py-2 rounded-md text-sm font-medium transition-colors">About</a>
                </div>
            </div>
        </div>
    </div>
</nav>

<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8">

    <!-- Analysis Card -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center">
            <div>
                <h2 class="text-lg font-semibold text-slate-800">Analyze Project</h2>
                <p class="text-xs text-slate-500">Configure parameters and run detection</p>
            </div>
            <div class="flex gap-2">
                <button onclick='process();' id="bt_process" class="inline-flex items-center px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white text-sm font-medium rounded-lg shadow-sm transition-all focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                    <i class="fa-solid fa-play mr-2"></i> Process Selected
                </button>
                <button onclick='process_all();' id="bt_process_all" class="inline-flex items-center px-4 py-2 bg-slate-800 hover:bg-slate-900 text-white text-sm font-medium rounded-lg shadow-sm transition-all">
                    <i class="fa-solid fa-layer-group mr-2"></i> Process All
                </button>
            </div>
        </div>
        
        <div class="p-6 grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Left: Projects -->
            <div class="space-y-4">
                <div class="flex justify-between items-center">
                    <label class="block text-sm font-medium text-slate-700">Select Projects <span id="lista_project_qtd" class="ml-1 px-2 py-0.5 rounded-full bg-slate-100 text-slate-600 text-xs">0</span></label>
                    <span class="text-xs text-slate-400"><i class="fas fa-keyboard mr-1"></i>Ctrl+Click to select multiple</span>
                </div>
                <div class="relative">
                    <select id="select_project" multiple class="block w-full rounded-lg border-slate-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm min-h-[280px] p-2 bg-slate-50">
                        <!-- Options populated by JS -->
                    </select>
                </div>
            </div>

            <!-- Right: Smells -->
            <div class="space-y-4">
                <div class="flex justify-between items-center">
                    <label class="block text-sm font-medium text-slate-700">Detection Rules</label>
                    <div class="space-x-2">
                        <button onclick="selectAllSmells()" class="text-xs text-primary-600 hover:text-primary-800 font-medium">Select All</button>
                        <span class="text-slate-300">|</span>
                        <button onclick="deselectAllSmells()" class="text-xs text-slate-500 hover:text-slate-700 font-medium">Clear</button>
                    </div>
                </div>
                
                <div class="bg-slate-50 rounded-lg border border-slate-200 p-4 h-[280px] overflow-y-auto">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                        <!-- Checkbox Item Template -->
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="assertion_roulette" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500 transition duration-150 ease-in-out">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Assertion Roulette</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="conditional_test_logic" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Conditional Test Logic</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="default_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Default Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="duplicate_assert" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Duplicate Assert</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="eager_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Eager Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="empty_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Empty Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="exception_handling" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Exception Handling</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="expected_resolution_omission" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Expected Resolution Omission</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="ignored_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Ignored Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="lazy_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Lazy Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="magic_number" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Magic Number</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="mystery_guest" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Mystery Guest</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="print_statment_fixture" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Print Statement</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="redundant_assertion" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Redundant Assertion</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="residual_state" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Residual State</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="resource_optimism" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Resource Optimism</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="sensitive_equality" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Sensitive Equality</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="sleepy_fixture" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Sleepy Fixture</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="test_without_description" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">No Description</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="unknown_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Unknown Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="verbose_test" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Verbose Test</span>
                        </label>
                        <label class="flex items-start space-x-3 p-2 rounded hover:bg-white transition-colors cursor-pointer group">
                            <input type="checkbox" id="widget_setup" checked class="mt-1 h-4 w-4 text-primary-600 border-slate-300 rounded focus:ring-primary-500">
                            <span class="text-sm text-slate-600 group-hover:text-slate-900">Widget Setup</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="px-6 py-4 bg-slate-50 border-t border-slate-200">
            <div class="flex flex-col space-y-3">
                <div class="flex justify-between items-end">
                    <label class="text-xs font-semibold uppercase text-slate-500 tracking-wider">
                        Processed Projects Log
                    </label>
                    <span class="text-xs text-rose-500 font-medium" id="project_qts"></span>
                </div>
                <textarea id="projectname" readonly
                    class="w-full h-24 rounded-lg border-slate-300 bg-white text-xs font-mono text-slate-600 shadow-sm focus:border-primary-500 focus:ring-primary-500 p-3"
                    placeholder="Waiting for analysis..."></textarea>
        
                <div class="flex flex-wrap gap-2 pt-2" id="download-buttons">
                    <a id="resultado" href="/download"
                        class="px-4 py-2 bg-amber-100 text-amber-800 rounded-full text-xs font-bold uppercase tracking-wide hover:bg-amber-200 transition-colors">
                        <i class="fa-solid fa-file-csv mr-1"></i> CSV 1
                    </a>
                    <a id="resultado2" href="/download2"
                        class="px-4 py-2 bg-amber-100 text-amber-800 rounded-full text-xs font-bold uppercase tracking-wide hover:bg-amber-200 transition-colors">
                        <i class="fa-solid fa-file-csv mr-1"></i> CSV 2
                    </a>
                    <a id="resultado3" href="/download_metrics"
                        class="px-4 py-2 bg-emerald-100 text-emerald-800 rounded-full text-xs font-bold uppercase tracking-wide hover:bg-emerald-200 transition-colors">
                        <i class="fa-solid fa-chart-simple mr-1"></i> Metrics 1
                    </a>
                    <a id="resultado4" href="/download_metrics2"
                        class="px-4 py-2 bg-emerald-100 text-emerald-800 rounded-full text-xs font-bold uppercase tracking-wide hover:bg-emerald-200 transition-colors">
                        <i class="fa-solid fa-chart-line mr-1"></i> Metrics 2
                    </a>
                    <a id="resultado_db" href="/download.db"
                        class="px-4 py-2 bg-indigo-100 text-indigo-800 rounded-full text-xs font-bold uppercase tracking-wide hover:bg-indigo-200 transition-colors">
                        <i class="fa-solid fa-database mr-1"></i> Database
                    </a>
                </div>
            </div>
        </div>
        
    </div>

    <!-- Statistics Grid (Agora apenas container vertical) -->
<div class="grid grid-cols-1 gap-6">

    <!-- Stats Table -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
        <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-semibold text-slate-800">Global Statistics</h3>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                <span id="qtd_test_files" class="mr-1">0</span> Test Files
            </span>
        </div>
        <div id="qtdbytestsmellbytype" class="overflow-x-auto text-sm text-slate-600"></div>
    </div>

    <!-- FULL WIDTH CHARTS -->

    <!-- OVERALL SMELLS -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
        <h4 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">Overall Smells</h4>
        <div class="relative w-full flex justify-center">
            <canvas id="myChart" class="w-full max-w-4xl h-96"></canvas>
        </div>
    </div>

    <!-- LOG SCALE -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
        <h4 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">Log Scale</h4>
        <div class="relative w-full flex justify-center">
            <canvas id="myChart2" class="w-full max-w-4xl h-96"></canvas>
        </div>
    </div>

    <!-- AUTHORS -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
        <h4 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">Authors</h4>
        <div class="relative w-full flex justify-center">
            <canvas id="myChart3" class="w-full max-w-4xl h-96"></canvas>
        </div>
    </div>

    <!-- AUTHORS x SENTIMENT -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
        <h4 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">Authors x Sentiment</h4>
        <div class="relative w-full flex justify-center">
            <canvas id="myChart4" class="w-full max-w-4xl h-96"></canvas>
        </div>
    </div>

    <!-- SMELLS x SENTIMENT -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
        <h4 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">Smells x Sentiment</h4>
        <div class="relative w-full flex justify-center">
            <canvas id="myChart5" class="w-full max-w-4xl h-96"></canvas>
        </div>
    </div>

    <!-- DATA LISTS -->

    <!-- AUTHORS TIMELINE -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-[400px]">
        <div class="px-6 py-4 border-b border-slate-100">
            <h3 class="font-semibold text-slate-800">Authors Timeline</h3>
        </div>
        <div class="flex-1 overflow-y-auto p-4" id="listAuthorStartEnd"></div>
    </div>

    <!-- COMMIT FREQUENCY -->
    <div class="bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-[400px]">
        <div class="px-6 py-4 border-b border-slate-100">
            <h3 class="font-semibold text-slate-800">Commit Frequency</h3>
        </div>
        <div class="flex-1 overflow-y-auto p-4" id="listAuthorQtdCommit"></div>
    </div>

</div>
         

</main>

<footer class="bg-white border-t border-slate-200 mt-12 py-8">
    <div class="max-w-7xl mx-auto px-4 text-center">
        <p class="text-sm text-slate-500">
            &copy; 2024 <strong>DNose</strong> created by <a href="https://tassiovirginio.github.io" target="_blank" class="text-primary-600 hover:text-primary-700 font-medium">Tássio Virgínio</a>
        </p>
        <div class="mt-2">
            <a href="https://dnose-ts.github.io/" target="_blank" class="text-xs text-slate-400 hover:text-slate-600 transition-colors">Documentation & Site</a>
        </div>
    </div>
</footer>

<div id="loading" class="loading-overlay">
    <div class="bg-white p-8 rounded-2xl shadow-2xl flex flex-col items-center max-w-sm w-full mx-4">
        <div class="w-12 h-12 border-4 border-primary-100 border-t-primary-600 rounded-full animate-spin mb-4"></div>
        <h3 class="text-lg font-bold text-slate-800 mb-2">Processing...</h3>
        <p class="text-sm text-slate-500 text-center mb-4">
            Analyzing repositories and detecting smells. This might take a while.
        </p>
        <div class="w-full bg-slate-100 rounded-full h-2">
            <div class="bg-primary-600 h-2 rounded-full w-3/3 animate-pulse"></div>
        </div>
    </div>
</div>


</body>
</html>